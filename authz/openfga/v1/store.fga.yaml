name: Custom Roles
model_file: ./schema.fga
tuples:
  # Hierarchies: server_1 -> project_1 -> (warehouse_1 (unmanaged), warehouse_2 (managed access))
  - user: server:server_1
    relation: parent
    object: project:project_1
  - user: project:project_1
    relation: child
    object: server:server_1
  - user: warehouse:warehouse_1
    relation: child
    object: project:project_1
  - user: project:project_1
    relation: parent
    object: warehouse:warehouse_1
  - user: warehouse:warehouse_2
    relation: child
    object: project:project_1
  - user: project:project_1
    relation: parent
    object: warehouse:warehouse_2
  # Hierarchies: warehouse_1 -> namespace_1 -> (table_1, table_2)
  - user: warehouse:warehouse_1
    relation: parent
    object: namespace:namespace_1
  - user: namespace:namespace_1
    relation: child
    object: warehouse:warehouse_1
  - user: table:table_1
    relation: child
    object: namespace:namespace_1
  - user: namespace:namespace_1
    relation: parent
    object: table:table_1
  # Hierarchies: warehouse_1 -> namespace_1_1 -> namespace_1_2 -> (table_3, view_1)
  - user: warehouse:warehouse_1
    relation: parent
    object: namespace:namespace_1_1
  - user: namespace:namespace_1_1
    relation: child
    object: warehouse:warehouse_1
  - user: namespace:namespace_1_1
    relation: parent
    object: namespace:namespace_1_2
  - user: namespace:namespace_1_2
    relation: child
    object: namespace:namespace_1_1
  - user: table:table_3
    relation: child
    object: namespace:namespace_1_2
  - user: namespace:namespace_1_2
    relation: parent
    object: table:table_3
  - user: view:view_1
    relation: child
    object: namespace:namespace_1_2
  - user: namespace:namespace_1_2
    relation: parent
    object: view:view_1
  # Hierarchies: warehouse_2 -> namespace_2_1 -> namespace_2_2 -> table_2_2
  - user: warehouse:warehouse_2
    relation: parent
    object: namespace:namespace_2_1
  - user: namespace:namespace_2_1
    relation: child
    object: warehouse:warehouse_2
  - user: namespace:namespace_2_1
    relation: parent
    object: namespace:namespace_2_2
  - user: namespace:namespace_2_2
    relation: child
    object: namespace:namespace_2_1
  - user: table:table_2_2
    relation: child
    object: namespace:namespace_2_2
  - user: namespace:namespace_2_2
    relation: parent
    object: table:table_2_2
  # warehouse_2 has managed access
  - user: role:*
    relation: managed_access
    object: warehouse:warehouse_2
  - user: user:*
    relation: managed_access
    object: warehouse:warehouse_2
  # Roles (Global Admin)
  - user: user:global_admin
    relation: global_admin
    object: server:server_1
  # Roles (Project 1 project admin)
  - user: user:project_1_project_admin
    relation: project_admin
    object: project:project_1
  # Roles (Project 1 security admin)
  - user: user:project_1_security_admin
    relation: security_admin
    object: project:project_1
  # Roles (Project 1 warehouse admin)
  - user: user:project_1_warehouse_admin
    relation: warehouse_admin
    object: project:project_1
  # Roles (Warehouse 1 owner)
  - user: user:warehouse_1_owner
    relation: ownership
    object: warehouse:warehouse_1
  # Roles (Namespace 2 Owner)
  - user: user:namespace_1_1_owner
    relation: ownership
    object: namespace:namespace_1_1
  # Roles (Select on Table 3)
  - user: user:select_table_3
    relation: assignee
    object: role:select_table_3
  - user: role:select_table_3#assignee
    relation: select
    object: table:table_3
  # Roles (Owner on warehouse_2)
  - user: user:warehouse_2_owner
    relation: ownership
    object: warehouse:warehouse_2
  # Roles (Owner on namespace_1_1)
  - user: user:namespace_2_1_owner
    relation: ownership
    object: namespace:namespace_2_1
  # Roles (Owner on namespace_2_2)
  - user: user:namespace_2_2_owner
    relation: ownership
    object: namespace:namespace_2_2
  - user: user:table_2_2_owner
    relation: ownership
    object: table:table_2_2
  # Roles (Owner role on namespace_2_1)
  - user: role:namespace_2_1_owner#assignee
    relation: ownership
    object: namespace:namespace_2_1
  - user: user:namespace_2_1_role_owner
    relation: assignee
    object: role:namespace_2_1_owner
tests:
  - name: Test Global Admin
    check:
      - user: user:global_admin
        object: server:server_1
        assertions:
          can_create_project: true
      - user: user:global_admin
        object: project:project_1
        assertions:
          can_create_warehouse: true
          can_delete: true
          can_get_metadata: true
          can_list_warehouses: true
          can_include_in_list: true
          can_rename: true
          can_grant_create: true
          can_grant_describe: true
          can_grant_modify: true
          can_grant_select: true
          can_grant_project_admin: true
          can_grant_security_admin: true
          can_grant_warehouse_admin: true
      - user: user:global_admin
        object: warehouse:warehouse_1
        assertions:
          can_create_namespace: true
          can_delete: true
          can_modify_storage: true
          can_modify_storage_credential: true
          can_get_metadata: true
          can_get_config: true
          can_list_namespaces: true
          can_use: true
          can_include_in_list: true
          can_deactivate: true
          can_activate: true
          can_rename: true
          can_list_deleted_tabulars: true
          can_grant_create: true
          can_grant_describe: true
          can_grant_modify: true
          can_grant_select: true
          can_grant_pass_grants: true
          can_grant_manage_grants: true
          can_change_ownership: true
      - user: user:global_admin
        object: namespace:namespace_1
        assertions:
          can_create_table: true
          can_create_view: true
          can_create_namespace: true
          can_delete: true
          can_update_properties: true
          can_get_metadata: true
          can_list_tables: true
          can_list_views: true
          can_list_namespaces: true
          can_grant_create: true
          can_grant_describe: true
          can_grant_modify: true
          can_grant_select: true
          can_grant_pass_grants: true
          can_grant_manage_grants: true
          can_change_ownership: true
      - user: user:global_admin
        object: table:table_3
        assertions:
          can_drop: true
          can_write_data: true
          can_read_data: true
          can_get_metadata: true
          can_commit: true
          can_rename: true
          can_include_in_list: true
          can_grant_pass_grants: true
          can_grant_manage_grants: true
          can_grant_describe: true
          can_grant_select: true
          can_grant_modify: true
          can_change_ownership: true
      - user: user:global_admin
        object: view:view_1
        assertions:
          can_drop: true
          can_commit: true
          can_get_metadata: true
          can_rename: true
          can_include_in_list: true
          can_grant_pass_grants: true
          can_grant_manage_grants: true
          can_grant_describe: true
          can_grant_modify: true
          can_change_ownership: true
  - name: Project Admin has full access in project and below
    check:
    - user: user:project_1_project_admin
      object: project:project_1
      assertions:
        can_create_warehouse: true
        can_delete: true
        can_get_metadata: true
        can_list_warehouses: true
        can_include_in_list: true
        can_rename: true
        can_grant_create: true
        can_grant_describe: true
        can_grant_modify: true
        can_grant_select: true
        can_grant_project_admin: true
        can_grant_security_admin: true
        can_grant_warehouse_admin: true
    - user: user:project_1_project_admin
      object: warehouse:warehouse_1
      assertions:
        can_create_namespace: true
        can_delete: true
        can_modify_storage: true
        can_modify_storage_credential: true
        can_get_metadata: true
        can_get_config: true
        can_list_namespaces: true
        can_use: true
        can_include_in_list: true
        can_deactivate: true
        can_activate: true
        can_rename: true
        can_list_deleted_tabulars: true
        can_grant_create: true
        can_grant_describe: true
        can_grant_modify: true
        can_grant_select: true
        can_grant_pass_grants: true
        can_grant_manage_grants: true
        can_change_ownership: true
    - user: user:project_1_project_admin
      object: namespace:namespace_1
      assertions:
        can_create_table: true
        can_create_view: true
        can_create_namespace: true
        can_delete: true
        can_update_properties: true
        can_get_metadata: true
        can_list_tables: true
        can_list_views: true
        can_list_namespaces: true
        can_grant_create: true
        can_grant_describe: true
        can_grant_modify: true
        can_grant_select: true
        can_grant_pass_grants: true
        can_grant_manage_grants: true
        can_change_ownership: true
    - user: user:project_1_project_admin
      object: table:table_3
      assertions:
        can_drop: true
        can_write_data: true
        can_read_data: true
        can_get_metadata: true
        can_commit: true
        can_rename: true
        can_include_in_list: true
        can_grant_pass_grants: true
        can_grant_manage_grants: true
        can_grant_describe: true
        can_grant_select: true
        can_grant_modify: true
        can_change_ownership: true
    - user: user:project_1_project_admin
      object: view:view_1
      assertions:
        can_drop: true
        can_commit: true
        can_get_metadata: true
        can_rename: true
        can_include_in_list: true
        can_grant_pass_grants: true
        can_grant_manage_grants: true
        can_grant_describe: true
        can_grant_modify: true
        can_change_ownership: true
  - name: Security Admin can manage grants and naviagate but not see data
    check:
    - user: user:project_1_security_admin
      object: project:project_1
      assertions:
        can_create_warehouse: false
        can_delete: false
        can_get_metadata: true
        can_list_warehouses: true
        can_include_in_list: true
        can_rename: false
        can_grant_create: true
        can_grant_describe: true
        can_grant_modify: true
        can_grant_select: true
        can_grant_project_admin: false
        can_grant_security_admin: true
        can_grant_warehouse_admin: false
    - user: user:project_1_security_admin
      object: warehouse:warehouse_1
      assertions:
        can_create_namespace: false
        can_delete: false
        can_modify_storage: false
        can_modify_storage_credential: false
        can_get_metadata: true
        can_get_config: true
        can_list_namespaces: true
        can_use: true
        can_include_in_list: true
        can_deactivate: false
        can_activate: false
        can_rename: false
        can_list_deleted_tabulars: true
        can_grant_create: true
        can_grant_describe: true
        can_grant_modify: true
        can_grant_select: true
        can_grant_pass_grants: true
        can_grant_manage_grants: true
        can_change_ownership: true
    - user: user:project_1_security_admin
      object: namespace:namespace_1
      assertions:
        can_create_table: false
        can_create_view: false
        can_create_namespace: false
        can_delete: false
        can_update_properties: false
        can_get_metadata: true
        can_list_tables: true
        can_list_views: true
        can_include_in_list: true
        can_list_namespaces: true
        can_grant_create: true
        can_grant_describe: true
        can_grant_modify: true
        can_grant_select: true
        can_grant_pass_grants: true
        can_grant_manage_grants: true
        can_change_ownership: true
    - user: user:project_1_security_admin
      object: table:table_3
      assertions:
        can_drop: false
        can_write_data: false
        can_read_data: false
        can_get_metadata: true
        can_commit: false
        can_rename: false
        can_include_in_list: true
        can_grant_pass_grants: true
        can_grant_manage_grants: true
        can_grant_describe: true
        can_grant_select: true
        can_grant_modify: true
        can_change_ownership: true
    - user: user:project_1_security_admin
      object: view:view_1
      assertions:
        can_drop: false
        can_commit: false
        can_get_metadata: true
        can_rename: false
        can_include_in_list: true
        can_grant_pass_grants: true
        can_grant_manage_grants: true
        can_grant_describe: true
        can_grant_modify: true
        can_change_ownership: true
  - name: Warehouse Admin can manage data and objects but not grants
    check:
    - user: user:project_1_warehouse_admin
      object: project:project_1
      assertions:
        can_create_warehouse: true
        can_delete: false
        can_get_metadata: true
        can_list_warehouses: true
        can_include_in_list: true
        can_rename: false
        can_grant_create: false
        can_grant_describe: false
        can_grant_modify: false
        can_grant_select: false
        can_grant_project_admin: false
        can_grant_security_admin: false
        can_grant_warehouse_admin: true
    - user: user:project_1_warehouse_admin
      object: warehouse:warehouse_1
      assertions:
        can_create_namespace: true
        can_delete: true
        can_modify_storage: true
        can_modify_storage_credential: true
        can_get_metadata: true
        can_get_config: true
        can_list_namespaces: true
        can_use: true
        can_include_in_list: true
        can_deactivate: true
        can_activate: true
        can_rename: true
        can_list_deleted_tabulars: true
        can_grant_create: false
        can_grant_describe: false
        can_grant_modify: false
        can_grant_select: false
        can_grant_pass_grants: false
        can_grant_manage_grants: false
        can_change_ownership: false
    - user: user:project_1_warehouse_admin
      object: namespace:namespace_1
      assertions:
        can_create_table: true
        can_create_view: true
        can_create_namespace: true
        can_delete: true
        can_update_properties: true
        can_get_metadata: true
        can_list_tables: true
        can_list_views: true
        can_list_namespaces: true
        can_include_in_list: true
        can_grant_create: false
        can_grant_describe: false
        can_grant_modify: false
        can_grant_select: false
        can_grant_pass_grants: false
        can_grant_manage_grants: false
        can_change_ownership: false
    - user: user:project_1_warehouse_admin
      object: table:table_3
      assertions:
        can_drop: true
        can_write_data: true
        can_read_data: true
        can_get_metadata: true
        can_commit: true
        can_rename: true
        can_include_in_list: true
        can_grant_pass_grants: false
        can_grant_manage_grants: false
        can_grant_describe: false
        can_grant_select: false
        can_grant_modify: false
        can_change_ownership: false
    - user: user:project_1_warehouse_admin
      object: view:view_1
      assertions:
        can_drop: true
        can_commit: true
        can_get_metadata: true
        can_rename: true
        can_include_in_list: true
        can_grant_pass_grants: false
        can_grant_manage_grants: false
        can_grant_describe: false
        can_grant_modify: false
        can_change_ownership: false
  - name: Warehouse Owner can do everything in its Warehouse
    check:
    - user: user:warehouse_1_owner
      object: warehouse:warehouse_1
      assertions:
        can_create_namespace: true
        can_delete: true
        can_modify_storage: true
        can_modify_storage_credential: true
        can_get_metadata: true
        can_get_config: true
        can_list_namespaces: true
        can_use: true
        can_include_in_list: true
        can_deactivate: true
        can_activate: true
        can_rename: true
        can_list_deleted_tabulars: true
        can_grant_create: true
        can_grant_describe: true
        can_grant_modify: true
        can_grant_select: true
        can_grant_pass_grants: true
        can_grant_manage_grants: true
        can_change_ownership: true
    - user: user:warehouse_1_owner
      object: namespace:namespace_1
      assertions:
        can_create_table: true
        can_create_view: true
        can_create_namespace: true
        can_delete: true
        can_update_properties: true
        can_get_metadata: true
        can_list_tables: true
        can_list_views: true
        can_include_in_list: true
        can_list_namespaces: true
        can_grant_create: true
        can_grant_describe: true
        can_grant_modify: true
        can_grant_select: true
        can_grant_pass_grants: true
        can_grant_manage_grants: true
        can_change_ownership: true
    - user: user:warehouse_1_owner
      object: table:table_3
      assertions:
        can_drop: true
        can_write_data: true
        can_read_data: true
        can_get_metadata: true
        can_commit: true
        can_rename: true
        can_include_in_list: true
        can_grant_pass_grants: true
        can_grant_manage_grants: true
        can_grant_describe: true
        can_grant_select: true
        can_grant_modify: true
        can_change_ownership: true
    - user: user:warehouse_1_owner
      object: view:view_1
      assertions:
        can_drop: true
        can_commit: true
        can_get_metadata: true
        can_rename: true
        can_include_in_list: true
        can_grant_pass_grants: true
        can_grant_manage_grants: true
        can_grant_describe: true
        can_grant_modify: true
        can_change_ownership: true
  - name: Namespace Owner can do everyting in their Namespace but not above
    check:
    - user: user:namespace_1_1_owner
      object: project:project_1
      assertions:
        can_create_warehouse: false
        can_delete: false
        can_get_metadata: true
        can_list_warehouses: true
        can_include_in_list: true
        can_rename: false
        can_grant_create: false
        can_grant_describe: false
        can_grant_modify: false
        can_grant_select: false
        can_grant_project_admin: false
        can_grant_security_admin: false
        can_grant_warehouse_admin: false
    - user: user:namespace_1_1_owner
      object: namespace:namespace_1_1
      assertions:
        can_create_table: true
        can_create_view: true
        can_create_namespace: true
        can_delete: true
        can_update_properties: true
        can_get_metadata: true
        can_list_tables: true
        can_list_views: true
        can_include_in_list: true
        can_list_namespaces: true
        can_grant_create: true
        can_grant_describe: true
        can_grant_modify: true
        can_grant_select: true
        can_grant_pass_grants: true
        can_grant_manage_grants: true
        can_change_ownership: true
    - user: user:namespace_1_1_owner
      object: namespace:namespace_1
      assertions:
        can_create_table: false
        can_create_view: false
        can_create_namespace: false
        can_delete: false
        can_update_properties: false
        can_get_metadata: false
        can_list_tables: false
        can_list_views: false
        can_list_namespaces: false
        can_grant_create: false
        can_grant_describe: false
        can_include_in_list: false
        can_grant_modify: false
        can_grant_select: false
        can_grant_pass_grants: false
        can_grant_manage_grants: false
        can_change_ownership: false
    - user: user:namespace_1_1_owner
      object: table:table_3
      assertions:
        can_drop: true
        can_write_data: true
        can_read_data: true
        can_get_metadata: true
        can_commit: true
        can_rename: true
        can_include_in_list: true
        can_grant_pass_grants: true
        can_grant_manage_grants: true
        can_grant_describe: true
        can_grant_select: true
        can_grant_modify: true
        can_change_ownership: true
    - user: user:namespace_1_1_owner
      object: view:view_1
      assertions:
        can_drop: true
        can_commit: true
        can_get_metadata: true
        can_rename: true
        can_include_in_list: true
        can_grant_pass_grants: true
        can_grant_manage_grants: true
        can_grant_describe: true
        can_grant_modify: true
        can_change_ownership: true
  - name: Select Table 3 bubbles list up
    check:
    - user: user:select_table_3
      object: project:project_1
      assertions:
        can_create_warehouse: false
        can_delete: false
        can_get_metadata: true
        can_list_warehouses: true
        can_include_in_list: true
        can_rename: false
        can_grant_create: false
        can_grant_describe: false
        can_grant_modify: false
        can_grant_select: false
        can_grant_project_admin: false
        can_grant_security_admin: false
        can_grant_warehouse_admin: false
    - user: user:select_table_3
      object: warehouse:warehouse_1
      assertions:
        can_create_namespace: false
        can_delete: false
        can_modify_storage: false
        can_modify_storage_credential: false
        can_get_metadata: true
        can_get_config: true
        can_list_namespaces: true
        can_use: true
        can_include_in_list: true
        can_deactivate: false
        can_activate: false
        can_rename: false
        can_list_deleted_tabulars: true
        can_grant_create: false
        can_grant_describe: false
        can_grant_modify: false
        can_grant_select: false
        can_grant_pass_grants: false
        can_grant_manage_grants: false
        can_change_ownership: false
    - user: user:select_table_3
      object: namespace:namespace_1
      assertions:
        can_create_table: false
        can_create_view: false
        can_create_namespace: false
        can_delete: false
        can_update_properties: false
        can_get_metadata: false
        can_list_tables: false
        can_list_views: false
        can_list_namespaces: false
        can_include_in_list: false
        can_grant_create: false
        can_grant_describe: false
        can_grant_modify: false
        can_grant_select: false
        can_grant_pass_grants: false
        can_grant_manage_grants: false
        can_change_ownership: false
    - user: user:select_table_3
      object: namespace:namespace_1_1
      assertions:
        can_create_table: false
        can_create_view: false
        can_create_namespace: false
        can_delete: false
        can_update_properties: false
        can_get_metadata: true
        can_list_tables: true
        can_list_views: true
        can_list_namespaces: true
        can_include_in_list: true
        can_grant_create: false
        can_grant_describe: false
        can_grant_modify: false
        can_grant_select: false
        can_grant_pass_grants: false
        can_grant_manage_grants: false
        can_change_ownership: false
    - user: user:select_table_3
      object: table:table_3
      assertions:
        can_drop: false
        can_write_data: false
        can_read_data: true
        can_get_metadata: true
        can_commit: false
        can_rename: false
        can_include_in_list: true
        can_grant_pass_grants: false
        can_grant_manage_grants: false
        can_grant_describe: false
        can_grant_select: false
        can_grant_modify: false
        can_change_ownership: false
  - name: Managed access on warehouse owner can modify warehouse and below
    check:
    - user: user:warehouse_2_owner
      object: warehouse:warehouse_2
      assertions:
        can_create_namespace: true
        can_delete: true
        can_modify_storage: true
        can_modify_storage_credential: true
        can_get_metadata: true
        can_get_config: true
        can_list_namespaces: true
        can_use: true
        can_include_in_list: true
        can_deactivate: true
        can_activate: true
        can_rename: true
        can_list_deleted_tabulars: true
        can_grant_create: true
        can_grant_describe: true
        can_grant_modify: true
        can_grant_select: true
        can_grant_pass_grants: true
        can_grant_manage_grants: true
        can_change_ownership: true
    - user: user:warehouse_2_owner
      object: namespace:namespace_2_1
      assertions:
        can_create_table: true
        can_create_view: true
        can_create_namespace: true
        can_delete: true
        can_update_properties: true
        can_get_metadata: true
        can_list_tables: true
        can_list_views: true
        can_list_namespaces: true
        can_include_in_list: true
        can_grant_create: true
        can_grant_describe: true
        can_grant_modify: true
        can_grant_select: true
        can_grant_pass_grants: true
        can_grant_manage_grants: true
        can_change_ownership: true
    - user: user:warehouse_2_owner
      object: namespace:namespace_2_2
      assertions:
        can_create_table: true
        can_create_view: true
        can_create_namespace: true
        can_delete: true
        can_update_properties: true
        can_get_metadata: true
        can_list_tables: true
        can_list_views: true
        can_list_namespaces: true
        can_include_in_list: true
        can_grant_create: true
        can_grant_describe: true
        can_grant_modify: true
        can_grant_select: true
        can_grant_pass_grants: true
        can_grant_manage_grants: true
        can_change_ownership: true
    - user: user:warehouse_2_owner
      object: table:table_2_2
      assertions:
        can_drop: true
        can_write_data: true
        can_read_data: true
        can_get_metadata: true
        can_commit: true
        can_rename: true
        can_include_in_list: true
        can_grant_pass_grants: true
        can_grant_manage_grants: true
        can_grant_describe: true
        can_grant_select: true
        can_grant_modify: true
        can_change_ownership: true
  - name: Managed access on warehouse blocks namespace owner grants
    check:
    - user: user:namespace_2_1_owner
      object: project:project_1
      assertions:
        can_create_warehouse: false
        can_delete: false
        can_get_metadata: true
        can_list_warehouses: true
        can_include_in_list: true
        can_rename: false
        can_grant_create: false
        can_grant_describe: false
        can_grant_modify: false
        can_grant_select: false
        can_grant_project_admin: false
        can_grant_security_admin: false
        can_grant_warehouse_admin: false
    - user: user:namespace_2_1_owner
      object: warehouse:warehouse_2
      assertions:
        can_create_namespace: false
        can_delete: false
        can_modify_storage: false
        can_modify_storage_credential: false
        can_get_metadata: true
        can_get_config: true
        can_list_namespaces: true
        can_use: true
        can_include_in_list: true
        can_deactivate: false
        can_activate: false
        can_rename: false
        can_list_deleted_tabulars: true
        can_grant_create: false
        can_grant_describe: false
        can_grant_modify: false
        can_grant_select: false
        can_grant_pass_grants: false
        can_grant_manage_grants: false
        can_change_ownership: false
    - user: user:namespace_2_1_owner
      object: namespace:namespace_2_1
      assertions:
        can_create_table: true
        can_create_view: true
        can_create_namespace: true
        can_delete: true
        can_update_properties: true
        can_get_metadata: true
        can_list_tables: true
        can_list_views: true
        can_list_namespaces: true
        can_include_in_list: true
        can_grant_create: false
        can_grant_describe: false
        can_grant_modify: false
        can_grant_select: false
        can_grant_pass_grants: false
        can_grant_manage_grants: false
        can_change_ownership: false
    - user: user:table_2_2_owner
      object: table:table_2_2
      assertions:
        can_drop: true
        can_write_data: true
        can_read_data: true
        can_get_metadata: true
        can_commit: true
        can_rename: true
        can_include_in_list: true
        can_grant_pass_grants: false
        can_grant_manage_grants: false
        can_grant_describe: false
        can_grant_select: false
        can_grant_modify: false
        can_change_ownership: false
  - name: Managed access enforced in sub-namespaces
    check:
    - user: user:namespace_2_2_owner
      object: project:project_1
      assertions:
        can_create_warehouse: false
        can_delete: false
        can_get_metadata: true
        can_list_warehouses: true
        can_include_in_list: true
        can_rename: false
        can_grant_create: false
        can_grant_describe: false
        can_grant_modify: false
        can_grant_select: false
        can_grant_project_admin: false
        can_grant_security_admin: false
        can_grant_warehouse_admin: false
    - user: user:namespace_2_2_owner
      object: warehouse:warehouse_2
      assertions:
        can_create_namespace: false
        can_delete: false
        can_modify_storage: false
        can_modify_storage_credential: false
        can_get_metadata: true
        can_get_config: true
        can_list_namespaces: true
        can_use: true
        can_include_in_list: true
        can_deactivate: false
        can_activate: false
        can_rename: false
        can_list_deleted_tabulars: true
        can_grant_create: false
        can_grant_describe: false
        can_grant_modify: false
        can_grant_select: false
        can_grant_pass_grants: false
        can_grant_manage_grants: false
        can_change_ownership: false
    - user: user:namespace_2_2_owner
      object: namespace:namespace_2_1
      assertions:
        can_create_table: false
        can_create_view: false
        can_create_namespace: false
        can_delete: false
        can_update_properties: false
        can_get_metadata: true
        can_list_tables: true
        can_list_views: true
        can_list_namespaces: true
        can_include_in_list: true
        can_grant_create: false
        can_grant_describe: false
        can_grant_modify: false
        can_grant_select: false
        can_grant_pass_grants: false
        can_grant_manage_grants: false
        can_change_ownership: false
    - user: user:namespace_2_2_owner
      object: namespace:namespace_2_2
      assertions:
        can_create_table: true
        can_create_view: true
        can_create_namespace: true
        can_delete: true
        can_update_properties: true
        can_get_metadata: true
        can_list_tables: true
        can_list_views: true
        can_list_namespaces: true
        can_include_in_list: true
        can_grant_create: false
        can_grant_describe: false
        can_grant_modify: false
        can_grant_select: false
        can_grant_pass_grants: false
        can_grant_manage_grants: false
        can_change_ownership: false
    - user: user:namespace_2_2_owner
      object: table:table_2_2
      assertions:
        can_drop: true
        can_write_data: true
        can_read_data: true
        can_get_metadata: true
        can_commit: true
        can_rename: true
        can_include_in_list: true
        can_grant_pass_grants: false
        can_grant_manage_grants: false
        can_grant_describe: false
        can_grant_select: false
        can_grant_modify: false
        can_change_ownership: false
    - user: user:table_2_2_owner
      object: table:table_2_2
      assertions:
        can_drop: true
        can_write_data: true
        can_read_data: true
        can_get_metadata: true
        can_commit: true
        can_rename: true
        can_include_in_list: true
        can_grant_pass_grants: false
        can_grant_manage_grants: false
        can_grant_describe: false
        can_grant_select: false
        can_grant_modify: false
        can_change_ownership: false
  - name: Managed access for roles enforced in sub-namespaces
    check:
    - user: user:namespace_2_1_role_owner
      object: project:project_1
      assertions:
        can_create_warehouse: false
        can_delete: false
        can_get_metadata: true
        can_list_warehouses: true
        can_include_in_list: true
        can_rename: false
        can_grant_create: false
        can_grant_describe: false
        can_grant_modify: false
        can_grant_select: false
        can_grant_project_admin: false
        can_grant_security_admin: false
        can_grant_warehouse_admin: false
    - user: role:namespace_2_1_owner#assignee
      object: project:project_1
      assertions:
        can_create_warehouse: false
        can_delete: false
        can_get_metadata: true
        can_list_warehouses: true
        can_include_in_list: true
        can_rename: false
        can_grant_create: false
        can_grant_describe: false
        can_grant_modify: false
        can_grant_select: false
        can_grant_project_admin: false
        can_grant_security_admin: false
        can_grant_warehouse_admin: false
    - user: user:namespace_2_1_role_owner
      object: warehouse:warehouse_2
      assertions:
        can_create_namespace: false
        can_delete: false
        can_modify_storage: false
        can_modify_storage_credential: false
        can_get_metadata: true
        can_get_config: true
        can_list_namespaces: true
        can_use: true
        can_include_in_list: true
        can_deactivate: false
        can_activate: false
        can_rename: false
        can_list_deleted_tabulars: true
        can_grant_create: false
        can_grant_describe: false
        can_grant_modify: false
        can_grant_select: false
        can_grant_pass_grants: false
        can_grant_manage_grants: false
        can_change_ownership: false
    - user: role:namespace_2_1_owner#assignee
      object: warehouse:warehouse_2
      assertions:
        can_create_namespace: false
        can_delete: false
        can_modify_storage: false
        can_modify_storage_credential: false
        can_get_metadata: true
        can_get_config: true
        can_list_namespaces: true
        can_use: true
        can_include_in_list: true
        can_deactivate: false
        can_activate: false
        can_rename: false
        can_list_deleted_tabulars: true
        can_grant_create: false
        can_grant_describe: false
        can_grant_modify: false
        can_grant_select: false
        can_grant_pass_grants: false
        can_grant_manage_grants: false
        can_change_ownership: false
    - user: user:namespace_2_1_role_owner
      object: namespace:namespace_2_1
      assertions:
        can_create_table: true
        can_create_view: true
        can_create_namespace: true
        can_delete: true
        can_update_properties: true
        can_get_metadata: true
        can_list_tables: true
        can_list_views: true
        can_list_namespaces: true
        can_include_in_list: true
        can_grant_create: false
        can_grant_describe: false
        can_grant_modify: false
        can_grant_select: false
        can_grant_pass_grants: false
        can_grant_manage_grants: false
        can_change_ownership: false
    - user: user:table_2_2_owner
      object: table:table_2_2
      assertions:
        can_drop: true
        can_write_data: true
        can_read_data: true
        can_get_metadata: true
        can_commit: true
        can_rename: true
        can_include_in_list: true
        can_grant_pass_grants: false
        can_grant_manage_grants: false
        can_grant_describe: false
        can_grant_select: false
        can_grant_modify: false
        can_change_ownership: false

